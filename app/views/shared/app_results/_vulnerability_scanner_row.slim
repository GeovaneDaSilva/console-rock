- show_checkbox = nil if local_assigns[:show_checkbox].nil?
- show_details = nil if local_assigns[:show_details].nil?
- query_params ||= nil
- show_customer_link ||= true

tr
  - if show_checkbox
    td.pl-0 = check_box_tag "app_results[]", app_result.id, checked: true
  td
    - if app_result.malicious?
      span.text-danger title="Malicious"
        i.fa.fa-exclamation-triangle
    - if app_result.suspicious?
      span.text-warning title="Suspicious"
        i.fa.fa-exclamation-triangle
    - if app_result.informational?
      span.text-informational title="Informational"
        i.fa.fa-exclamation-triangle

  | &nbsp;
  td = l app_result.detection_date, format: :digital
  - if app_result.customer.nil?
    td
  - else
    - if show_customer_link
      td.customer = link_to app_result.customer.name, account_triage_url(app_result.customer, (query_params || {}).merge(switch_account_id: app_result.customer.id, host: ENV.fetch(I18n.t('application.host')), protocol: 'https')), target: "_blank", title: "Triage this App for #{app_result.customer.name}"
    - else
      td.customer
        | #{app_result.customer.name.titleize}

  td.device = link_to app_result.device.hostname, device_triage_url(app_result.device, query_params.merge(host: ENV.fetch(I18n.t('application.host')), protocol: 'https')), target: "_blank", target: "_blank", title: "Triage this App for #{app_result.device.hostname}"
  td = app_result.details.scan_start_type || " Scheduled "
  td = app_result.value
  td = app_result.details.total_vulnerabilities || " - "
  td = app_result.details.max_vulnerable_cvss_score || " - "
  - if show_details
    td.pr-0.text-right
      a data-toggle="modal" data-target="#app_results_modal" data-content-target="app-result-#{app_result.id}-detail" Details
